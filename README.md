# ezsign.py

株式会社サンテクノロジーの電子ペーパーディスプレイ「Santek EZ Sign 4.2” E-paper Display」とUSBシリアル通信して指定のページを表示、指定のページのイメージデータを読み取ってファイル保存、指定のページに画像ファイルのデータ書き込みするライブラリです。

[Santek EZ Sign 4.2](https://www.santekshop.jp/product/santek-ez-sign-4-2-e-paper-display/)



## 使い方

PCなどと有線USB接続し、シリアルポート名を確認します。Windowsではデバイスマネージャから接続したときに発生したCOMポート名を調べます。

Linuxなどではmessagesログに名前が出ると思うのでそちらを調べます。

シリアルポート名の例

    COM3 
    /dev/ttyACM0 
    /dev/tty.usbserial-Disabled

EZ Sign 4.2の電源をオン状態にしてください。オフ状態でもPC側ではシリアルポートとして認識されますが、EZSignライブラリからコマンドを送っても反応しません。

EZ Sign 4.2の電源がオン状態(LEDが青点灯)で使用してください。

### pythonライブラリして使う場合

pythonライブラリして使う場合は所定のライブラリディレクトリに配置して、 EZSignクラスを呼び出してください。

pyserial、PILが必要です。(PILはイメージの読み書きに使っているだけなのでpillowでも代替可能とは思います。)

シリアルポートをpyserialで開いてそれをEZSignのコンストラクタの第一引数に渡します。ボーレートとパリティ設定は以下のようにしてください。

    Serial_Port=serial.Serial('COM3', baudrate=38400, parity= 'N')
    ezsign = EZSign(Serial_Port)

#### 指定のページを表示

    ezsign.showpage(ページ番号)

ページ番号は1～5まで。EZSign.NEXTを指定すると次のページ、EZSign.PREVを指定すると前のページへの切り替えになります。

ページ書き換えは30秒程度かかります。書き換え中はEZ Sign 4.2のLEDが点滅します。

#### 指定のページのイメージデータを読み取ってファイル保存

    ezsign.readimage(ページ番号, 保存先ファイル名)

ページ番号は1～5まで。保存先ファイル名は'image01.png'などを指定します。

PILのsave()を使っているので拡張子を指定することでそのフォーマットになります。

#### 指定のページに画像ファイルのデータを書き込む

    ezsign.writeimage(ページ番号, 保存先ファイル名)

ページ番号は1～5まで。書き込む画像ファイル名は'image01.png'などを指定します。

PILのopen()を使っているのでPILが対応している画像ファイルは読み込むことができます。

画像ファイル中の白ピクセル(255, 255, 255)、黒ピクセル(0,0,0)、赤ピクセル(255, 0, 0)が電子ペーパーに反映されます。

画像ファイルの幅、高さはなんでも大丈夫ですが、内部で400x300にリサイズされますので400x300以外のサイズの画像データではゆがんだり、リサイズ時のノイズが乗ったりします。


### そのまま実行する場合のコマンドライン引数

シリアルポート名と、コマンドと引数を指定します。

#### 指定のページを表示

    例 1ページ目を表示
    python EZSign.py COM3 -s 1

#### 指定のページのイメージデータを読み取ってファイル保存

    例 1ページ目のイメージデータを 読み取ってimage.pngに保存
    python EZSign.py -r 1 image.png

#### 指定のページに画像ファイルのデータを書き込む

    例 image.pngを1ページ目として書き込む
    python EZSign.py -w 1 image.png

EZSign.pyでEZ Sign 4.2を操作しようとしてもうんともすんとも言わなくなった場合は、PCとEZ Sign 4.2の有線USB接続をいったん外して、再度接続してから試してみてください。EZ Sign 4.2が電源オン状態(LEDが青点灯、緑ではありません)かどうかを確認してください。